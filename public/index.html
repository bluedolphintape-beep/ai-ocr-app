<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Live Skaner Email</title>

<style>
body{
font-family:Arial;
background:#111;
color:white;
text-align:center;
padding:20px;
}

video{
width:100%;
max-width:400px;
border-radius:15px;
}

button{
padding:15px 25px;
font-size:18px;
background:#00bcd4;
border:none;
border-radius:10px;
color:white;
margin-top:20px;
}

canvas{
display:none;
}
</style>
</head>

<body>

<h2>ðŸ“¸ Live Skaner Email</h2>

<video id="video" autoplay playsinline></video>
<br>
<button onclick="scan()">Skanuj</button>

<p id="result"></p>

<canvas id="canvas"></canvas>

<script>

const video = document.getElementById("video");
const canvas = document.getElementById("canvas");

async function startCamera(){

const stream = await navigator.mediaDevices.getUserMedia({
video:{
facingMode:"environment"
}
});

video.srcObject = stream;

}

startCamera();

async function scan(){

document.getElementById("result").innerText="SkanujÄ™...";

const ctx = canvas.getContext("2d");

canvas.width = video.videoWidth;
canvas.height = video.videoHeight;

ctx.drawImage(video,0,0);

const blob = await new Promise(r => canvas.toBlob(r,"image/jpeg"));

const form = new FormData();
form.append("image", blob, "scan.jpg");

const res = await fetch("/ocr",{
method:"POST",
body: form
});

const data = await res.json();

document.getElementById("result").innerText=
"ðŸ“§ Email: "+data.email;

}

</script>

</body>
</html>
