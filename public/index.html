<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Skaner Email â€“ LIVE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
font-family: Arial, sans-serif;
text-align: center;
background: #003869;
padding: 20px;
color: #fff;
}

video {
width: 100%;
max-width: 400px;
border-radius: 12px;
margin: auto;
}

button {
padding: 1em 2em;
font-size: 1.1em;
background-color: #007bff;
color: #fff;
border: none;
border-radius: 8px;
cursor: pointer;
margin-top: 20px;
}

button:hover {
background: #0056b3;
}

#info {
margin-top: 20px;
font-weight: bold;
}
</style>
</head>

<body>

<h2>ğŸ“· Zeskanuj Email z obrazu</h2>

<video id="video" autoplay playsinline></video>
<br>
<button onclick="scan()">ğŸ“¸ Skanuj</button>

<p id="info"></p>

<canvas id="canvas" style="display:none"></canvas>

<script>

const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const info = document.getElementById("info");

async function startCamera() {

try {

const stream = await navigator.mediaDevices.getUserMedia({
video: { facingMode: "environment" }
});

video.srcObject = stream;

} catch (e) {
info.innerText = "âŒ Brak dostÄ™pu do kamery";
}

}

startCamera();

async function scan() {

info.innerText = "â³ SkanujÄ™ obraz...";

const ctx = canvas.getContext("2d");

canvas.width = video.videoWidth;
canvas.height = video.videoHeight;

ctx.drawImage(video, 0, 0);

const blob = await new Promise(r => canvas.toBlob(r, "image/jpeg"));

const form = new FormData();
form.append("image", blob, "scan.jpg");

try {

const res = await fetch("/ocr", {
method: "POST",
body: form
});

const data = await res.json();

info.innerText = "ğŸ“§ Email: " + data.email;

} catch (e) {

info.innerText = "âŒ BÅ‚Ä…d OCR";

}

}

</script>

</body>
</html>
